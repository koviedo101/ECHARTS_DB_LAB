CREATE ALGORITHM=UNDEFINED DEFINER=`renato`@`%` SQL SECURITY DEFINER VIEW `i_objetivos_per_project` AS select `t`.`fecha` AS `fecha`,`t`.`project_id` AS `project_id`,(case when ((dayofmonth(`t`.`fecha`) = 1) and (dayofweek(`t`.`fecha`) = 1)) then 0 when ((dayofmonth(`t`.`fecha`) = 2) and (dayofweek(`t`.`fecha`) = 1)) then (1 / 6) when ((dayofmonth(`t`.`fecha`) = 3) and (dayofweek(`t`.`fecha`) = 1)) then (2 / 6) when ((dayofmonth(`t`.`fecha`) = 4) and (dayofweek(`t`.`fecha`) = 1)) then (3 / 6) when ((dayofmonth(`t`.`fecha`) = 5) and (dayofweek(`t`.`fecha`) = 1)) then (4 / 6) when ((dayofmonth(`t`.`fecha`) = 6) and (dayofweek(`t`.`fecha`) = 1)) then (5 / 6) else 1 end) AS `multiplicador_extra`,(case when (dayofweek(`t`.`fecha`) = 1) then 0 when (dayofweek(`t`.`fecha`) = 7) then 4 else 8 end) AS `objetivo`,`t`.`employee_id` AS `employee_id`,if((`f`.`id` is null),1,2) AS `multiplicador_feriado`,(case when (`t`.`inicio` >= '14:00:00') then ceiling((timestampdiff(SECOND,`t`.`inicio`,`t`.`fin`) / 3600)) when (`t`.`fin` < '14:00:00') then ceiling((timestampdiff(SECOND,`t`.`inicio`,`t`.`fin`) / 3600)) else (ceiling((timestampdiff(SECOND,`t`.`inicio`,`t`.`fin`) / 3600)) - 1) end) AS `cumplido` from (`trabajo` `t` left join `festividades` `f` on(((dayofmonth(`t`.`fecha`) = `f`.`dia`) and (month(`t`.`fecha`) = `f`.`mes`))))