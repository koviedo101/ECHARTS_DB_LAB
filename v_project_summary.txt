CREATE ALGORITHM=UNDEFINED DEFINER=`renato`@`%` SQL SECURITY DEFINER VIEW `v_project_summary` AS select `p`.`id` AS `project_id`,min(1) AS `id`,min('Cotizado') AS `descripcion`,ifnull(sum((`c`.`cantidad` * `c`.`precio`)),0) AS `positivo`,0 AS `negativo` from (`projects` `p` left join `cotizaciones` `c` on((`c`.`project_id` = `p`.`id`))) group by `p`.`id` union select `p`.`id` AS `project_id`,min(2) AS `id`,min('Ingresos') AS `descripcion`,min(floor((rand() * 100000))) AS `positivo`,min(0) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(3) AS `id`,min('Egresos') AS `descripcion`,min(0) AS `positivo`,min(floor((rand() * 100000))) AS `negativo` from (`projects` `p` left join `gastos` `c` on((`c`.`project_id` = `p`.`id`))) group by `p`.`id` union select `p`.`id` AS `project_id`,min(4) AS `id`,min('Margen') AS `descripcion`,min(floor((rand() * 100000))) AS `positivo`,min(0) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(5) AS `id`,min('IVA') AS `descripcion`,min(0) AS `positivo`,min(floor((rand() * 100000))) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(6) AS `id`,min('ISR') AS `descripcion`,min(0) AS `positivo`,min(floor((rand() * 100000))) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(7) AS `id`,min('Utilidad neta') AS `descripcion`,min(floor((rand() * 100000))) AS `positivo`,min(0) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(8) AS `id`,min('Mano de obra') AS `descripcion`,min(0) AS `positivo`,min(floor((rand() * 100000))) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(9) AS `id`,min('Gastos no deducibles') AS `descripcion`,min(0) AS `positivo`,min(floor((rand() * 100000))) AS `negativo` from `projects` `p` group by `p`.`id` union select `p`.`id` AS `project_id`,min(10) AS `id`,min('Utilidad final') AS `descripcion`,min(floor((rand() * 100000))) AS `positivo`,min(0) AS `negativo` from `projects` `p` group by `p`.`id` order by `project_id`,`id`