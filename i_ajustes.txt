CREATE ALGORITHM=UNDEFINED DEFINER=`renato`@`%` SQL SECURITY DEFINER VIEW `i_ajustes` AS select `t`.`id` AS `id`,month(`a`.`fecha`) AS `mes`,year(`a`.`fecha`) AS `year`,sum(if((`a`.`valor` < 0),0,`a`.`valor`)) AS `positivos`,sum(if((`a`.`valor` < 0),(`a`.`valor` * -(1)),0)) AS `negativos` from (`trabajadores` `t` left join `ajustes` `a` on((`a`.`trabajador_id` = `t`.`id`))) group by `t`.`id`,month(`a`.`fecha`),year(`a`.`fecha`)